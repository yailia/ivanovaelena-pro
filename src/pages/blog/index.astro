---
import Layout from '../../components/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import Breadcrumbs from '../../components/seo/Breadcrumbs.astro';
import { getCollection } from 'astro:content';
import { entryToBlogPost } from '../../utils/content';
import { formatDate } from '../../utils/date';

const blogEntries = await getCollection('blog');
const posts = blogEntries
	.map(entryToBlogPost)
	.sort((a, b) => b.date.getTime() - a.date.getTime());
---

<Layout 
	title="Блог психолога — статьи о тревоге, КПТ и саморегуляции | Елена Иванова"
	description="Полезные статьи психолога Елены Ивановой: техники КПТ, работа с тревогой, управление стрессом, осознанность и саморегуляция."
>
	<Header />
	<main class="blog-page">
		<section class="section">
			<div class="container">
				<Breadcrumbs items={[
					{ name: 'Блог', url: '/blog' },
				]} />
				<header class="blog-hero">
					<p class="eyebrow">Осознанность • КПТ • Поддержка</p>
					<h1>Блог</h1>
					<p class="blog-intro">
						Практики, техники и наблюдения, которые помогают проживать тревогу, беречь внимание и выстраивать устойчивую жизнь.
					</p>
				</header>

				<div class="blog-grid">
					{posts.length > 0 ? (
						posts.map((post) => (
							<article class="blog-card">
								<div class="blog-card-content">
									<div class="meta">
										<time>{formatDate(post.date)}</time>
										<span>·</span>
										<span>{post.readingTime} мин чтения</span>
									</div>
									<h2>
										<a href={`/blog/${post.id}`}>{post.title}</a>
									</h2>
									<p class="excerpt">{post.excerpt}</p>
									{post.tags.length > 0 && (
										<ul class="blog-tags">
											{post.tags.map((tag) => (
												<li>{tag}</li>
											))}
										</ul>
									)}
								</div>
							</article>
						))
					) : (
						<p>Статьи появятся здесь скоро.</p>
					)}
				</div>
			</div>
		</section>
	</main>
	<Footer />
</Layout>

<style>
	.blog-page {
		background: #ecfdf9;
		padding-bottom: 4rem;
	}

	.blog-hero {
		max-width: 640px;
		margin-bottom: 3rem;
	}

	.eyebrow {
		text-transform: uppercase;
		font-size: 0.85rem;
		letter-spacing: 0.2em;
		color: #3a8dff;
		margin-bottom: 0.75rem;
	}

	h1 {
		font-size: clamp(2.5rem, 4vw, 3.5rem);
		margin: 0;
		color: #1f2a2e;
	}

	.blog-intro {
		font-size: 1.25rem;
		color: #545454;
		margin-top: 1rem;
		line-height: 1.6;
	}

	.blog-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
		gap: 2.5rem;
	}

	.blog-card {
		background: white;
		border-radius: 16px;
		border: 1px solid rgba(111, 216, 197, 0.3);
		overflow: hidden;
		display: flex;
		flex-direction: column;
		box-shadow: 0 12px 30px rgba(31, 42, 46, 0.04);
		transition: transform 0.3s ease, box-shadow 0.3s ease;
	}

	.blog-card:hover {
		transform: translateY(-6px);
		box-shadow: 0 24px 40px rgba(31, 42, 46, 0.08);
	}

	.blog-card-content {
		padding: 1.75rem;
		display: flex;
		flex-direction: column;
		gap: 1rem;
	}

	.meta {
		display: flex;
		align-items: center;
		gap: 0.5rem;
		font-size: 0.95rem;
		color: #7a8b90;
	}

	.blog-card h2 {
		margin: 0;
		font-size: 1.5rem;
		color: #1f2a2e;
	}

	.blog-card h2 a {
		color: inherit;
		text-decoration: none;
	}

	.blog-card h2 a:hover {
		color: #3a8dff;
	}

	.excerpt {
		color: #545454;
		line-height: 1.6;
		margin: 0;
	}

	.blog-tags {
		display: flex;
		flex-wrap: wrap;
		gap: 0.5rem;
		padding: 0;
		list-style: none;
		margin: 0;
	}

	.blog-tags li {
		font-size: 0.85rem;
		padding: 0.35rem 0.9rem;
		border-radius: 999px;
		background: #f4f9f7;
		color: #3a8dff;
		border: 1px solid rgba(58, 141, 255, 0.15);
	}

	@media (max-width: 768px) {
		.blog-card-content {
			padding: 1.25rem;
		}

		.blog-grid {
			gap: 1.5rem;
		}
	}
</style>

