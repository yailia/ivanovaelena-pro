---
import Layout from '../../components/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro'];
import Breadcrumbs from '../../components/seo/Breadcrumbs.astro';

const anxietyQuestions = [
  'Чувство напряжения',
  'Страх без видимой причины',
  'Беспокойство, которое трудно контролировать',
  'Чувство раздражительности',
  'Тревога мешает отдыху или расслаблению',
  'Приступы сильной тревоги или паники',
  'Общее чувство внутреннего беспокойства',
];

const depressionQuestions = [
  'Потеря интереса к привычным занятиям',
  'Угнетённое настроение большую часть времени',
  'Отсутствие радости от того, что раньше радовало',
  'Чувство безнадёжности в отношении будущего',
  'Трудности с принятием даже простых решений',
  'Чувство собственной никчёмности или обесценивания себя',
  'Снижение активности и мотивации что‑то делать',
];
---

<Layout 
  title="HADS — тревога и депрессия | Быстрый тест | Елена Иванова"
  description="HADS — опросник для самооценки уровня тревоги и депрессии за последнюю неделю. Две шкалы: тревога (A) и депрессия (D), каждая интерпретируется отдельно."
>
  <Header />
  <main>
    <section class="section">
      <div class="container">
        <Breadcrumbs items={[
          { name: 'Быстрые тесты', url: '/tests' },
          { name: 'HADS (тревога и депрессия)', url: '/tests/hads' },
        ]} />

        <a href="/tests" class="back-link">← Ко всем тестам</a>

        <h1>HADS (тревога и депрессия)</h1>
        <p class="intro">
          Инструкция: выберите вариант, который наиболее точно описывает ваше состояние за последнюю неделю.
        </p>

        <div class="scale-legend">
          <p><strong>Варианты ответа:</strong></p>
          <ul>
            <li>0 – совсем нет / редко</li>
            <li>1 – иногда</li>
            <li>2 – часто</li>
            <li>3 – почти всегда</li>
          </ul>
        </div>

        <form id="hads-form" class="test-form">
          <div class="scale-block">
            <h2>Шкала тревожности (A)</h2>
            <ol class="questions-list">
              {anxietyQuestions.map((q, index) => (
                <li class="question-item">
                  <div class="question-text">
                    {q}
                  </div>
                  <div class="options">
                    <label>
                      <input type="radio" name={`a${index + 1}`} value="0" required={index === 0} />
                      <span>0 — совсем нет / редко</span>
                    </label>
                    <label>
                      <input type="radio" name={`a${index + 1}`} value="1" />
                      <span>1 — иногда</span>
                    </label>
                    <label>
                      <input type="radio" name={`a${index + 1}`} value="2" />
                      <span>2 — часто</span>
                    </label>
                    <label>
                      <input type="radio" name={`a${index + 1}`} value="3" />
                      <span>3 — почти всегда</span>
                    </label>
                  </div>
                </li>
              ))}
            </ol>
          </div>

          <div class="scale-block">
            <h2>Шкала депрессии (D)</h2>
            <ol class="questions-list">
              {depressionQuestions.map((q, index) => (
                <li class="question-item">
                  <div class="question-text">
                    {q}
                  </div>
                  <div class="options">
                    <label>
                      <input type="radio" name={`d${index + 1}`} value="0" />
                      <span>0 — совсем нет / редко</span>
                    </label>
                    <label>
                      <input type="radio" name={`d${index + 1}`} value="1" />
                      <span>1 — иногда</span>
                    </label>
                    <label>
                      <input type="radio" name={`d${index + 1}`} value="2" />
                      <span>2 — часто</span>
                    </label>
                    <label>
                      <input type="radio" name={`d${index + 1}`} value="3" />
                      <span>3 — почти всегда</span>
                    </label>
                  </div>
                </li>
              ))}
            </ol>
          </div>

          <button type="submit" class="btn test-submit">Показать результат</button>
        </form>

        <div id="hads-result" class="result" aria-live="polite"></div>

        <div class="disclaimer">
          <p>
            HADS помогает аккуратно оценить уровень тревоги и депрессивной симптоматики, но не заменяет очную диагностику. 
            На ответы могут влиять текущие события, нагрузка, сон и уровень стресса.
          </p>
          <p>
            Если по одной или обеим шкалам балл оказывается повышенным, 
            это повод бережно отнестись к себе и при необходимости обсудить своё состояние со специалистом.
          </p>
          <a href="/contacts" class="btn disclaimer-cta">
            Обсудить результат на бесплатной консультации
          </a>
        </div>
      </div>
    </section>
  </main>
  <Footer />
</Layout>

<script>
  const form = document.getElementById('hads-form');
  const resultEl = document.getElementById('hads-result');

  function interpretSubscale(score, label) {
    if (score <= 7) {
      return {
        level: 'нормальный уровень',
        note: `${label}: выраженной симптоматики по этой шкале не наблюдается. Можно использовать результат как точку отсчёта и отслеживать динамику.`,
      };
    }
    if (score <= 10) {
      return {
        level: 'пограничный уровень',
        note: `${label}: есть признаки, на которые стоит обратить внимание. Возможно, имеет смысл мягко скорректировать режим, нагрузки и источники поддержки.`,
      };
    }
    return {
      level: 'выраженный уровень',
      note: `${label}: симптомы, скорее всего, заметно влияют на самочувствие и повседневную жизнь. Может быть полезно обратиться за профессиональной поддержкой.`,
    };
  }

  form?.addEventListener('submit', (e) => {
    e.preventDefault();

    const formData = new FormData(form);

    let anxietyScore = 0;
    let depressionScore = 0;

    // Тревога A1–A7
    for (let i = 1; i <= 7; i++) {
      const value = formData.get(`a${i}`);
      if (value === null) {
        resultEl.className = 'result result--error';
        resultEl.textContent = 'Пожалуйста, ответьте на все вопросы по шкале тревоги.';
        return;
      }
      anxietyScore += Number(value);
    }

    // Депрессия D1–D7
    for (let i = 1; i <= 7; i++) {
      const value = formData.get(`d${i}`);
      if (value === null) {
        resultEl.className = 'result result--error';
        resultEl.textContent = 'Пожалуйста, ответьте на все вопросы по шкале депрессии.';
        return;
      }
      depressionScore += Number(value);
    }

    const anxietyInterpretation = interpretSubscale(anxietyScore, 'Тревога');
    const depressionInterpretation = interpretSubscale(depressionScore, 'Депрессия');

    resultEl.className = 'result result--visible';
    resultEl.innerHTML = `
      <div class="result-block">
        <h3>Шкала тревожности (A)</h3>
        <p class="result-score">Ваш результат: <strong>${anxietyScore}</strong> баллов из 21</p>
        <p class="result-level">Уровень: <strong>${anxietyInterpretation.level}</strong></p>
        <p class="result-note">${anxietyInterpretation.note}</p>
      </div>
      <div class="result-block">
        <h3>Шкала депрессии (D)</h3>
        <p class="result-score">Ваш результат: <strong>${depressionScore}</strong> баллов из 21</p>
        <p class="result-level">Уровень: <strong>${depressionInterpretation.level}</strong></p>
        <p class="result-note">${depressionInterpretation.note}</p>
      </div>
    `;

    resultEl.scrollIntoView({ behavior: 'smooth', block: 'start' });
  });
</script>

<style>
  .back-link {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    margin-bottom: 1rem;
    font-size: 0.9rem;
    color: var(--color-text-secondary);
    text-decoration: none;
  }

  .back-link:hover {
    color: var(--color-accent);
  }

  .intro {
    margin-top: 0.75rem;
    color: var(--color-text-secondary);
    line-height: 1.7;
    max-width: 720px;
  }

  .scale-legend {
    margin-top: 1.5rem;
    padding: 1.25rem 1.5rem;
    border-radius: var(--radius-card);
    border: 1px solid var(--color-border);
    background: white;
    max-width: 520px;
  }

  .scale-legend ul {
    margin: 0.5rem 0 0 1.25rem;
    padding: 0;
    color: var(--color-text-secondary);
    line-height: 1.6;
  }

  .test-form {
    margin-top: 2.5rem;
    display: flex;
    flex-direction: column;
    gap: 2.5rem;
  }

  .scale-block h2 {
    margin-bottom: 1rem;
  }

  .questions-list {
    list-style: none;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  .question-item {
    padding: 1.5rem 1.75rem;
    border-radius: var(--radius-card);
    border: 1px solid var(--color-border);
    background: white;
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .question-text {
    font-weight: 500;
    color: var(--color-text-primary);
  }

  .options {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 0.75rem 1.5rem;
  }

  .options label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.95rem;
    color: var(--color-text-secondary);
    cursor: pointer;
  }

  .options input[type="radio"] {
    accent-color: var(--color-accent);
  }

  .test-submit {
    align-self: flex-start;
    min-width: 220px;
  }

  .result {
    margin-top: 2rem;
    padding: 0;
    border-radius: var(--radius-card);
    border: 1px solid transparent;
    background: transparent;
    opacity: 0;
    transform: translateY(4px);
    transition: all 0.2s ease;
  }

  .result--visible {
    padding: 1.5rem 1.75rem;
    background: rgba(111, 216, 197, 0.06);
    border-color: var(--color-border);
    opacity: 1;
    transform: translateY(0);
  }

  .result--error {
    padding: 1rem 1.25rem;
    background: rgba(231, 98, 95, 0.08);
    border-color: var(--color-error);
    color: var(--color-error);
    opacity: 1;
    transform: translateY(0);
  }

  .result-block + .result-block {
    margin-top: 1.25rem;
    padding-top: 1.25rem;
    border-top: 1px dashed rgba(31, 42, 46, 0.15);
  }

  .result-score,
  .result-level,
  .result-note {
    margin: 0 0 0.5rem 0;
    color: var(--color-text-primary);
    line-height: 1.6;
  }

  .result-note {
    margin-top: 0.5rem;
    color: var(--color-text-secondary);
  }

  .disclaimer {
    margin-top: 2.5rem;
    padding: 1.5rem 1.75rem;
    border-radius: var(--radius-card);
    background: var(--color-bg-primary);
    color: var(--color-text-secondary);
    line-height: 1.7;
    max-width: 820px;
  }

  .disclaimer-cta {
    margin-top: 1rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }

  @media (max-width: 768px) {
    .question-item {
      padding: 1.25rem 1.25rem;
    }

    .options {
      grid-template-columns: minmax(0, 1fr);
      gap: 0.5rem;
    }

    .test-submit {
      width: 100%;
    }

    .scale-legend,
    .disclaimer {
      padding: 1.25rem 1.25rem;
    }
  }
</style>


